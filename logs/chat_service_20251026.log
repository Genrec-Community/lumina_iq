2025-10-26 07:40:27 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 07:40:28 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 07:56:25 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 07:56:26 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 08:24:34 | INFO | chat_service | info:69 | {"message": "Starting document indexing", "data": {"filename": "Sniper Trading Plan.pdf", "content_length": 3003, "user_id": "user_2f3b4ff"}, "timestamp": "2025-10-26T02:54:34.871884", "logger": "chat_service"}
2025-10-26 08:24:35 | INFO | chat_service | info:69 | {"message": "Chunking with rich metadata extraction", "data": {"document_name": "Sniper Trading Plan.pdf", "chunk_size": 1000}, "timestamp": "2025-10-26T02:54:35.861592", "logger": "chat_service"}
2025-10-26 08:24:35 | INFO | chat_service | info:69 | {"message": "Split text into 4 chunks", "data": {"total_length": 3003, "avg_chunk_size": 750}, "timestamp": "2025-10-26T02:54:35.862433", "logger": "chat_service"}
2025-10-26 08:24:35 | INFO | chat_service | info:69 | Created 4 chunks with rich metadata
2025-10-26 08:24:35 | INFO | chat_service | info:69 | Metadata stats: 2 chapters, 0 sections found
2025-10-26 08:24:35 | INFO | chat_service | info:69 | {"message": "Created 4 chunks with rich metadata", "data": {"filename": "Sniper Trading Plan.pdf"}, "timestamp": "2025-10-26T02:54:35.873354", "logger": "chat_service"}
2025-10-26 08:24:35 | ERROR | chat_service | error:77 | {"message": "Failed to generate embedding for text 0", "data": {"error": "Together.ai API key not configured"}, "timestamp": "2025-10-26T02:54:35.875941", "logger": "chat_service"}
NoneType: None
2025-10-26 08:24:35 | ERROR | chat_service | error:77 | {"message": "Failed to index document", "data": {"filename": "Sniper Trading Plan.pdf", "error": "Together.ai API key not configured"}, "timestamp": "2025-10-26T02:54:35.879143", "logger": "chat_service"}
Traceback (most recent call last):
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/rag_service.py", line 117, in index_document
    embeddings = await EmbeddingService.generate_embeddings_batch(chunks_text)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/embedding_service.py", line 120, in generate_embeddings_batch
    raise emb
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/embedding_service.py", line 52, in generate_embedding
    raise ValueError("Together.ai API key not configured")
ValueError: Together.ai API key not configured
2025-10-26 08:24:35 | INFO | chat_service | info:69 | {"message": "Starting document indexing", "data": {"filename": "Sniper Trading Plan.pdf", "content_length": 3003, "user_id": "user_2f3b4ff"}, "timestamp": "2025-10-26T02:54:35.915196", "logger": "chat_service"}
2025-10-26 08:24:36 | INFO | chat_service | info:69 | {"message": "Chunking with rich metadata extraction", "data": {"document_name": "Sniper Trading Plan.pdf", "chunk_size": 1000}, "timestamp": "2025-10-26T02:54:36.151796", "logger": "chat_service"}
2025-10-26 08:24:36 | INFO | chat_service | info:69 | {"message": "Split text into 4 chunks", "data": {"total_length": 3003, "avg_chunk_size": 750}, "timestamp": "2025-10-26T02:54:36.152259", "logger": "chat_service"}
2025-10-26 08:24:36 | INFO | chat_service | info:69 | Created 4 chunks with rich metadata
2025-10-26 08:24:36 | INFO | chat_service | info:69 | Metadata stats: 2 chapters, 0 sections found
2025-10-26 08:24:36 | INFO | chat_service | info:69 | {"message": "Created 4 chunks with rich metadata", "data": {"filename": "Sniper Trading Plan.pdf"}, "timestamp": "2025-10-26T02:54:36.154282", "logger": "chat_service"}
2025-10-26 08:24:36 | ERROR | chat_service | error:77 | {"message": "Failed to generate embedding for text 0", "data": {"error": "Together.ai API key not configured"}, "timestamp": "2025-10-26T02:54:36.154787", "logger": "chat_service"}
NoneType: None
2025-10-26 08:24:36 | ERROR | chat_service | error:77 | {"message": "Failed to index document", "data": {"filename": "Sniper Trading Plan.pdf", "error": "Together.ai API key not configured"}, "timestamp": "2025-10-26T02:54:36.155115", "logger": "chat_service"}
Traceback (most recent call last):
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/rag_service.py", line 117, in index_document
    embeddings = await EmbeddingService.generate_embeddings_batch(chunks_text)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/embedding_service.py", line 120, in generate_embeddings_batch
    raise emb
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/embedding_service.py", line 52, in generate_embedding
    raise ValueError("Together.ai API key not configured")
ValueError: Together.ai API key not configured
2025-10-26 08:24:57 | INFO | chat_service | info:69 | {"message": "Retrieving context with ADVANCED RAG", "data": {"query_length": 2, "top_k": 5, "filename": "Sniper Trading Plan.pdf", "use_case": null}, "timestamp": "2025-10-26T02:54:57.779052", "logger": "chat_service"}
2025-10-26 08:24:57 | INFO | chat_service | info:69 | {"message": "Query classified as: chat", "data": {"confidence": "0.50", "matched_keywords": []}, "timestamp": "2025-10-26T02:54:57.780661", "logger": "chat_service"}
2025-10-26 08:24:57 | INFO | chat_service | info:69 | {"message": "Auto-detected use case: chat", "data": {"confidence": 0.5}, "timestamp": "2025-10-26T02:54:57.781053", "logger": "chat_service"}
2025-10-26 08:24:57 | INFO | chat_service | info:69 | {"message": "Extracted query metadata", "data": {"chapter": null, "section": null, "topic": null, "difficulty": "medium"}, "timestamp": "2025-10-26T02:54:57.784581", "logger": "chat_service"}
2025-10-26 08:24:57 | INFO | chat_service | info:69 | {"message": "Using CHAT retrieval strategy", "data": {"top_k": 5}, "timestamp": "2025-10-26T02:54:57.784982", "logger": "chat_service"}
2025-10-26 08:24:57 | ERROR | chat_service | error:77 | {"message": "CHAT strategy failed", "data": {"error": "Together.ai API key not configured"}, "timestamp": "2025-10-26T02:54:57.785378", "logger": "chat_service"}
Traceback (most recent call last):
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/retrieval_strategy_manager.py", line 106, in _chat_strategy
    query_embedding = await EmbeddingService.generate_query_embedding(query)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/embedding_service.py", line 135, in generate_query_embedding
    raise ValueError("Together.ai API key not configured")
ValueError: Together.ai API key not configured
2025-10-26 08:24:57 | INFO | chat_service | info:69 | {"message": "Advanced retrieval completed", "data": {"strategy": "chat", "num_chunks": 0}, "timestamp": "2025-10-26T02:54:57.786604", "logger": "chat_service"}
2025-10-26 08:24:57 | WARNING | chat_service | warning:73 | No relevant context found, falling back to full content preview
2025-10-26 08:24:57 | WARNING | chat_service | warning:73 | {"message": "AI generation attempt failed", "data": {"attempt": 1, "error": "Together.ai API key not configured"}, "timestamp": "2025-10-26T02:54:57.972500", "logger": "chat_service"}
2025-10-26 08:24:58 | WARNING | chat_service | warning:73 | {"message": "AI generation attempt failed", "data": {"attempt": 2, "error": "Together.ai API key not configured"}, "timestamp": "2025-10-26T02:54:58.458144", "logger": "chat_service"}
2025-10-26 08:24:58 | ERROR | chat_service | error:77 | {"message": "All AI generation attempts failed", "data": {"max_retries": 2, "error": "Together.ai API key not configured"}, "timestamp": "2025-10-26T02:54:58.458723", "logger": "chat_service"}
Traceback (most recent call last):
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/chat_service.py", line 134, in generate_content_async
    response = await TogetherService.generate_chat_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/together_service.py", line 146, in generate_chat_response
    return await TogetherService.generate_completion(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/together_service.py", line 71, in generate_completion
    raise ValueError("Together.ai API key not configured")
ValueError: Together.ai API key not configured
2025-10-26 08:24:58 | ERROR | chat_service | error:77 | {"message": "Failed to generate response", "data": {"token": "user_2f3b4ff8df82", "error": "Together.ai API key not configured"}, "timestamp": "2025-10-26T02:54:58.461310", "logger": "chat_service"}
Traceback (most recent call last):
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/chat_service.py", line 312, in chat
    ai_response = await generate_content_async(context)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/chat_service.py", line 134, in generate_content_async
    response = await TogetherService.generate_chat_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/together_service.py", line 146, in generate_chat_response
    return await TogetherService.generate_completion(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/together_service.py", line 71, in generate_completion
    raise ValueError("Together.ai API key not configured")
ValueError: Together.ai API key not configured
2025-10-26 08:27:22 | ERROR | chat_service | error:77 | {"message": "Failed to retrieve context", "data": {"query": "Generate comprehensive study notes on the topic \"Clarify a specific rule (e.g., how to identify a li", "error": "RetrievalStrategyManager._notes_strategy() got an unexpected keyword argument 'top_k'", "error_type": "TypeError", "traceback": "Traceback (most recent call last):\n  File \"/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/rag_service.py\", line 211, in retrieve_context\n    result = await retrieval_strategy_manager.retrieve(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/retrieval_strategy_manager.py\", line 70, in retrieve\n    result = await RetrievalStrategyManager._notes_strategy(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: RetrievalStrategyManager._notes_strategy() got an unexpected keyword argument 'top_k'\n"}, "timestamp": "2025-10-26T02:57:22.121680", "logger": "chat_service"}
Traceback (most recent call last):
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/rag_service.py", line 211, in retrieve_context
    result = await retrieval_strategy_manager.retrieve(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucifer/dev/projects/mixed_stacked/lumina_iq/backend/services/retrieval_strategy_manager.py", line 70, in retrieve
    result = await RetrievalStrategyManager._notes_strategy(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: RetrievalStrategyManager._notes_strategy() got an unexpected keyword argument 'top_k'
2025-10-26 08:27:22 | WARNING | chat_service | warning:73 | No relevant context found, falling back to full content preview
2025-10-26 19:43:25 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:43:25 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 19:43:45 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:43:48 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:43:49 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 19:44:01 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:44:02 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 19:44:09 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:44:09 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 19:44:50 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:44:51 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 19:45:10 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:45:11 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 19:45:29 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:45:30 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 19:46:23 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:46:24 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 19:46:41 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:46:42 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 19:52:20 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:53:47 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 19:53:49 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 20:13:37 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 20:13:38 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 20:14:12 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 20:14:12 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 20:14:19 | INFO | chat_service | info:69 | Qdrant client initialized successfully
2025-10-26 20:14:19 | INFO | chat_service | info:69 | Collection already exists: learning_app_documents
2025-10-26 21:30:31 | ERROR | chat_service | error:77 | {"message": "Failed to ensure collection exists", "data": {"error": "[Errno 113] No route to host"}, "timestamp": "2025-10-26T16:00:31.818645", "logger": "chat_service"}
2025-10-26 21:30:31 | ERROR | chat_service | error:77 | {"message": "Failed to initialize Qdrant client", "data": {"error": "[Errno 113] No route to host"}, "timestamp": "2025-10-26T16:00:31.820076", "logger": "chat_service"}
2025-10-26 22:15:06 | WARNING | chat_service | warning:73 | NLTK resource wordnet is missing
2025-10-26 22:16:51 | WARNING | chat_service | warning:73 | No relevant context found, falling back to full content preview
2025-10-26 22:17:34 | WARNING | chat_service | warning:73 | No relevant context found, falling back to full content preview
